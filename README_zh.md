<div align="center">
    <h1>
        JiuZhou: Open Foundation Language Models for Geoscience
    </h1>
</div>



\[ [English](README.md) | ä¸­æ–‡ \]

## ğŸ‰ æ–°é—»
- [2024-12-31] **æ–‡ç«  [JiuZhou: Open Foundation Language Models and Effective Pre-training Framework for Geoscience](https://www.tandfonline.com/doi/full/10.1080/17538947.2025.2449708) å·²è¢«*International Journal of Digital Earth*æœŸåˆŠæ¥æ”¶. [Code and Data](https://github.com/THU-ESIS/JiuZhou).**
- [2024-10-11] [æ–°æ–‡é€Ÿé€’|PreparedLLMï¼šé«˜æ•ˆè®­ç»ƒé¢†åŸŸå¤§è¯­è¨€æ¨¡å‹çš„â€œå‰é¢„è®­ç»ƒâ€æ¡†æ¶](https://mp.weixin.qq.com/s/ugJQ9tbp6Y87xA3TOWteqw)ã€‚
- [2024-09-06] å‘å¸ƒ[ClimateChat](https://huggingface.co/itpossible/ClimateChat)å¯¹è¯æ¨¡å‹ã€‚
- [2024-08-31] **æ–‡ç« [PreparedLLM: Effective Pre-pretraining Framework for Domain-specific Large Language Models](https://www.tandfonline.com/doi/full/10.1080/20964471.2024.2396159)å·²è¢«*Big Earth Data*æœŸåˆŠæ¥æ”¶**ã€‚
- [2024-08-31] å‘å¸ƒ[Chinese-Mistral-7B-Instruct-v0.2](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.2)å¯¹è¯æ¨¡å‹ã€‚è¯­è¨€ç†è§£èƒ½åŠ›å¤§å¹…æé«˜ï¼Œå¹¶ä¸”å…·å¤‡å¤šè½®å¯¹è¯èƒ½åŠ›ã€‚
- [2024-06-30] å‘å¸ƒ[JiuZhou-Instruct-v0.2](https://huggingface.co/itpossible/JiuZhou-Instruct-v0.2)å¯¹è¯æ¨¡å‹ã€‚è¯­è¨€ç†è§£èƒ½åŠ›å¤§å¹…æé«˜ï¼Œå¹¶ä¸”å…·å¤‡å¤šè½®å¯¹è¯èƒ½åŠ›ã€‚
- [2024-05-15] æ¨æ–‡[ä¸­æ–‡æ‰©è¯è¡¨å¢é‡é¢„è®­ç»ƒå¤§è¯­è¨€æ¨¡å‹Chinese-Mistralå‘å¸ƒ](https://mp.weixin.qq.com/s/PMQmRCZMWosWMfgKRBjLlQ)ã€‚
- [2024-04-04] å‘å¸ƒ[Chinese-Mistral-7B-Instruct-v0.1](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.1)å¯¹è¯æ¨¡å‹ã€‚
- [2024-03-31] å‘å¸ƒ[Chinese-Mistral-7B-v0.1](https://huggingface.co/itpossible/Chinese-Mistral-7B)åŸºåº§æ¨¡å‹ã€‚[Document](https://deepwiki.com/THU-ESIS/Chinese-Mistral).
- [2024-03-15] å‘å¸ƒJiuZhouçš„baseç‰ˆæœ¬[JiuZhou-base](https://huggingface.co/itpossible/JiuZhou-base)ã€instructç‰ˆæœ¬[JiuZhou-instruct-v0.1](https://huggingface.co/itpossible/JiuZhou-Instruct-v0.1)ï¼Œä»¥åŠ[ä¸­é—´æ£€æŸ¥ç‚¹](https://huggingface.co/itpossible). [Document](https://deepwiki.com/THU-ESIS/JiuZhou).


## ç›®å½•

- [æ¨¡å‹ä»‹ç»](#æ¨¡å‹ä»‹ç»)
- [æ¨¡å‹ä¸‹è½½](#æ¨¡å‹ä¸‹è½½)
- [æ¨¡å‹æ¨ç†](#æ¨¡å‹æ¨ç†)
- [æ¨¡å‹æ€§èƒ½](#æ¨¡å‹æ€§èƒ½)
- [æ¨¡å‹è®­ç»ƒè¿‡ç¨‹](#æ¨¡å‹è®­ç»ƒè¿‡ç¨‹)
- [æ¨¡å‹è®­ç»ƒä»£ç ](#æ¨¡å‹è®­ç»ƒä»£ç )
- [å¼•ç”¨](#å¼•ç”¨)
- [è‡´è°¢](#è‡´è°¢)

## æ¨¡å‹ä»‹ç»
åœ°çƒç§‘å­¦å­¦ç§‘å·²ç»ç§¯ç´¯äº†å¤§é‡çš„æ•°æ®ï¼Œä»è¿™äº›æ•°æ®ä¸­æå–å’Œæ•´åˆå¤šæ ·åŒ–çš„çŸ¥è¯†ï¼Œå¯¹äºåº”å¯¹å…¨çƒå˜åŒ–æŒ‘æˆ˜ã€æ¨åŠ¨å¯æŒç»­å‘å±•å’ŒåŠ é€Ÿç§‘å­¦å‘ç°å…·æœ‰é‡è¦æ„ä¹‰ã€‚åŸºç¡€å¤§è¯­è¨€æ¨¡å‹é¦–å…ˆé€šè¿‡åœ¨æµ·é‡æ–‡æœ¬æ•°æ®ä¸Šè¿›è¡Œè‡ªç›‘ç£é¢„è®­ç»ƒï¼Œè‡ªä¸»åœ°å­¦ä¹ å’Œæ•´åˆå…¶ä¸­çš„çŸ¥è¯†ï¼Œç„¶åé€šè¿‡æŒ‡ä»¤ç²¾è°ƒè·å¾—è§£å†³åœ°çƒç§‘å­¦é—®é¢˜çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œå½“åŸºç¡€è¯­è¨€æ¨¡å‹æ²¡æœ‰æŒæ¡è¶³å¤Ÿçš„åœ°çƒç§‘å­¦ä¸“ä¸šçŸ¥è¯†æ—¶ï¼Œä½¿ç”¨ç›¸å…³æŒ‡ä»¤æ•°æ®è¿›è¡ŒæŒ‡ä»¤ç²¾è°ƒå¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹ç”Ÿæˆä¸äº‹å®ä¸ç¬¦çš„å†…å®¹ã€‚ä¸ºäº†æé«˜æ¨¡å‹çš„å‡†ç¡®æ€§å’Œå®ç”¨æ€§ï¼Œæˆ‘ä»¬è¿«åˆ‡éœ€è¦ä¸€ä¸ªå¼ºå¤§çš„åœ°çƒç§‘å­¦åŸºç¡€è¯­è¨€æ¨¡å‹ã€‚<br>
æœ¬ç ”ç©¶å°†[Mistral-7B-v0.1](https://huggingface.co/mistralai/Mistral-7B-v0.1)ä½œä¸ºåŸºåº§æ¨¡å‹ï¼ŒåŸºäºå¤§é‡åœ°çƒç§‘å­¦è¯­æ–™ã€[é¢†åŸŸå¤§è¯­è¨€æ¨¡å‹â€œå‰é¢„è®­ç»ƒâ€æ¡†æ¶(PreparedLLM)](https://www.tandfonline.com/doi/full/10.1080/20964471.2024.2396159)ã€â€œä¸¤é˜¶æ®µé¢„è®­ç»ƒé¢„é€‚åº”â€ç®—æ³•è¿›è¡Œç»§ç»­é¢„è®­ç»ƒï¼Œæ„å»ºäº†åœ°çƒç§‘å­¦å¤§è¯­è¨€æ¨¡å‹JiuZhouã€‚

## æ¨¡å‹ä¸‹è½½
| **æ¨¡å‹ç³»åˆ—**            | **æ¨¡å‹**                           | **ä¸‹è½½åœ°å€**                               | **è¯´æ˜**                                                          |
|---------------------|----------------------------------|----------------------------------------|-----------------------------------------------------------------|
| **JiuZhou**         | JiuZhou-base                     | [Huggingface](https://huggingface.co/itpossible/JiuZhou-base)                            | åŸºåº§æ¨¡å‹ï¼ˆå…·å¤‡ä¸°å¯Œçš„åœ°çƒç§‘å­¦çŸ¥è¯†ï¼‰<br>                                     |
| **JiuZhou**                | JiuZhou-Instruct-v0.1            | [Huggingface](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.1)                            | æŒ‡ä»¤æ¨¡å‹ï¼ˆå¯¹é½ç¨å¯¼è‡´æŸå¤±äº†éƒ¨åˆ†åœ°çƒç§‘å­¦çŸ¥è¯†ï¼Œä½†å…·å¤‡æŒ‡ä»¤éµå¾ªèƒ½åŠ›ï¼‰<br>ä¸­è‹±æ–‡alpaca_gpt4å’Œgeosignalè¿›è¡Œloraå¾®è°ƒ |
| **JiuZhou**                | JiuZhou-Instruct-v0.2            | [HuggingFace](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.2)<br>[wisemodel](https://wisemodel.cn/models/itpossible/Chinese-Mistral-7B-Instruct-v0.2)<br>               | æŒ‡ä»¤æ¨¡å‹ï¼ˆå¯¹é½ç¨å¯¼è‡´æŸå¤±äº†éƒ¨åˆ†åœ°çƒç§‘å­¦çŸ¥è¯†ï¼Œä½†å…·å¤‡æŒ‡ä»¤éµå¾ªèƒ½åŠ›ï¼‰<br>è‡ªåˆ¶é«˜è´¨é‡æŒ‡ä»¤æ•°æ®è¿›è¡ŒæŒ‡ä»¤è°ƒä¼˜                  |
| **ClimateChat**         | ClimateChat                      | [HuggingFace](https://huggingface.co/itpossible/ClimateChat)<br>[wisemodel](https://wisemodel.cn/models/itpossible/ClimateChat)<br>               | æŒ‡ä»¤æ¨¡å‹<br>åŸºäºJiuZhou-baseè¿›è¡ŒæŒ‡ä»¤è°ƒä¼˜                                    |
| **Chinese-Mistral** | Chinese-Mistral-7B               | [HuggingFace](https://huggingface.co/itpossible/Chinese-Mistral-7B-v0.1)<br>[wisemodel](https://wisemodel.cn/models/itpossible/Chinese-Mistral-7B-v0.1)<br>[ModelScope](https://www.modelscope.cn/models/itpossible/Chinese-Mistral-7B-v0.1) | åŸºåº§æ¨¡å‹                                                            |
| **Chinese-Mistral**                | Chinese-Mistral-7B-Instruct-v0.1 | [HuggingFace](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.1)<br>[wisemodel](https://wisemodel.cn/models/itpossible/Chinese-Mistral-7B-Instruct-v0.1)<br>[ModelScope](https://www.modelscope.cn/models/itpossible/Chinese-Mistral-7B-Instruct-v0.1)               | æŒ‡ä»¤æ¨¡å‹<br>ä¸­è‹±æ–‡alpaca_gpt4è¿›è¡Œloraå¾®è°ƒ                                  |
| **Chinese-Mistral**                | Chinese-Mistral-7B-Instruct-v0.2 | [HuggingFace](https://huggingface.co/itpossible/Chinese-Mistral-7B-Instruct-v0.2)<br>[wisemodel](https://wisemodel.cn/models/itpossible/Chinese-Mistral-7B-Instruct-v0.2)<br> | æŒ‡ä»¤æ¨¡å‹<br>ç™¾ä¸‡æ¡é«˜è´¨é‡æŒ‡ä»¤è¿›è¡Œloraå¾®è°ƒ                                        |
| **PreparedLLM**     | Prepared-Llama                   | [Huggingface](https://huggingface.co/itpossible/Prepared-Llama)<br>[Wisemodel](https://wisemodel.cn/models/itpossible/PREPARED-Llama)               | åŸºåº§æ¨¡å‹<br>å°‘é‡åœ°å­¦æ•°æ®è¿›è¡Œå¢é‡é¢„è®­ç»ƒ<br>æ¨èä½¿ç”¨JiuZhou                            |


## æ¨¡å‹æ¨ç†
å¦‚ä¸‹æ˜¯ä½¿ç”¨JiuZhou-Instruct-v0.2è¿›è¡Œæ¨ç†çš„ä»£ç ç¤ºä¾‹ã€‚
```python
import torch
from transformers import AutoTokenizer, AutoModelForCausalLM

device = torch.device("cuda:0") if torch.cuda.is_available() else torch.device("cpu")

model_path = "itpossible/JiuZhou-Instruct-v0.2"
tokenizer = AutoTokenizer.from_pretrained(model_path)
model = AutoModelForCausalLM.from_pretrained(model_path, torch_dtype=torch.bfloat16, device_map=device)

text = "ä»€ä¹ˆæ˜¯åœ°çƒç§‘å­¦"
messages = [{"role": "user", "content": text}]

inputs = tokenizer.apply_chat_template(messages, return_tensors="pt").to(device)
outputs_id = model.generate(inputs, max_new_tokens=600, do_sample=True)
outputs = tokenizer.batch_decode(outputs_id, skip_special_tokens=True)[0]
print(outputs)
```

## æ¨¡å‹æ€§èƒ½

### æ¨¡å‹åœ°å­¦èƒ½åŠ›

æˆ‘ä»¬é‡‡ç”¨GeoBenchè¯„æµ‹JiuZhouçš„æ€§èƒ½ã€‚<br>
JiuZhouåœ¨å®¢è§‚é¢˜ä»»åŠ¡ä¸Šçš„å¾—åˆ†è¶…è¿‡äº†GPT-3.5ï¼š
<p align="center">
    <br>
    <img src="image/objective_score.png" width="800"/>
    <br>
</p>

JiuZhouåœ¨ä¸»è§‚é¢˜ä»»åŠ¡ä¸Šçš„å…­ä¸ªæŒ‡æ ‡çš„å¾—åˆ†è¶…è¿‡äº†åŸºçº¿æ¨¡å‹ï¼š
<p align="center">
    <br>
    <img src="image/subjective_score.png" width="800"/>
    <br>
</p>

### æ¨¡å‹é€šç”¨èƒ½åŠ›

æˆ‘ä»¬é‡‡ç”¨C-Evalã€CMMLUå’ŒMMLUä¸‰ä¸ªè¯„æµ‹æ•°æ®é›†è¯„ä¼°JiuZhouçš„æ€§èƒ½ã€‚<br>
ç›¸è¾ƒäºå…¶ä»–Llamaå’ŒMistralæ¨¡å‹çš„å˜ä½“ï¼ŒJiuZhouå…·æœ‰çªå‡ºè¡¨ç°ï¼š
<p align="center">
    <br>
    <img src="image/general_score.png" width="800"/>
    <br>
</p>

## æ¨¡å‹è®­ç»ƒè¿‡ç¨‹

### æ¨¡å‹è¯­æ–™
è¯­æ–™åº“æ¥æºäº5000ä¸‡ç¯‡é€šç”¨æ–‡æ¡£å’Œ340ä¸‡ç¯‡åœ°å­¦æ–‡æ¡£ã€‚
<p align="center">
    <br>
    <img src="image/JiuZhou-Corpus.png" width="800"/>
    <br>
</p>

### è®­ç»ƒæ¡†æ¶
é‡‡ç”¨æœ¬ç ”ç©¶æå‡ºçš„JiuZhou-Frameworkã€‚
<p align="center">
    <br>
    <img src="image/JiuZhou-Framework.png" width="800"/>
    <br>
</p>

### ä¸¤é˜¶æ®µé¢„é€‚åº”é¢„è®­ç»ƒç®—æ³•ï¼ˆTSPTï¼‰
æé«˜å¯¹æœ‰é™çš„åœ°å­¦æ•°æ®çš„ä½¿ç”¨æ•ˆç‡ï¼Œä¸€å®šç¨‹åº¦ä¸Šçªç ´äº†å¢é‡é¢„è®­ç»ƒé¢†åŸŸLLMæ—¶æ¨¡å‹å­¦ä¹ ä½æ•ˆçš„æŠ€æœ¯ç“¶é¢ˆã€‚<br>
TSPTä¸å•é˜¶æ®µè®­ç»ƒç®—æ³•çš„åŒºåˆ«ï¼š
<p align="center">
    <br>
    <img src="image/TSPT.png" width="800"/>
    <br>
</p>
TSPTä¸å•é˜¶æ®µè®­ç»ƒç®—æ³•çš„æ•ˆæœæ¯”è¾ƒï¼š
<p align="center">
    <br>
    <img src="image/TSPT_score.png" width="800"/>
    <br>
</p>


## æ¨¡å‹è®­ç»ƒä»£ç 
å¦‚ä¸‹å±•ç¤ºåŸºäº[LLaMA-Factory](https://github.com/hiyouga/LLaMA-Factory)å¼€æºæ¡†æ¶å¾®è°ƒJiuZhouã€‚

### é¡¹ç›®éƒ¨ç½²
```bash
git clone https://github.com/THU-ESIS/JiuZhou.git
cd JiuZhou
pip install -e ".[torch,metrics]"
```
### æ¨¡å‹è®­ç»ƒ
å¯¹JiuZhouè¿›è¡Œå¢é‡é¢„è®­ç»ƒï¼š
```bash
llamafactory-cli train examples/train_lora/JiuZhou_pretrain_sft.yaml
```
å¯¹JiuZhouè¿›è¡ŒæŒ‡ä»¤è°ƒä¼˜ï¼š
```bash
llamafactory-cli train examples/train_lora/JiuZhou_lora_sft.yaml
```
ä¸å¾®è°ƒåçš„JiuZhouå¯¹è¯ï¼š
```bash
llamafactory-cli chat examples/inference/JiuZhou_lora_sft.yaml
```
å°†æŒ‡ä»¤è°ƒä¼˜å¾—åˆ°çš„loraæƒé‡ä¸JiuZhouåŸå§‹æƒé‡è¿›è¡Œåˆå¹¶ï¼š
```bash
llamafactory-cli export examples/merge_lora/JiuZhou_lora_sft.yaml
```

## å¼•ç”¨
```bibtex
@article{chen2024preparedllm,
  author = {Chen, Zhou and Lin, Ming and Wang, Zimeng and Zang, Mingrun and Bai, Yuqi},
  title = {PreparedLLM: Effective Pre-pretraining Framework for Domain-specific Large Language Models},
  year = {2024},
  journal = {Big Earth Data},
  pages = {1--24},
  doi = {10.1080/20964471.2024.2396159},
  url = {https://doi.org/10.1080/20964471.2024.2396159}
}
```

## è‡´è°¢
- [LLaMA-Factory](https://github.com/hiyouga/LLaMA-Factory)
- [OpenCompass](https://github.com/open-compass/opencompass)
- [K2](https://github.com/davendw49/k2)
- [GeoGalactica](https://github.com/geobrain-ai/geogalactica)
- [BB-GeoGPT](https://github.com/AGI-GIS/BB-GeoGPT)
